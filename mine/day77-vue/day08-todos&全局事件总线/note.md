```js
<template></template>
<script>
export default {
  name: "",
};
</script>
<style></style>

```



## `Vue`自定义事件

### 给子组件标签绑定事件监听

1. 传入：子组件在使用时 ，在子组件标签上绑定事件

   ```js
   
   <Child @plusName="plusFunc" />
   ```

   1. `Child`组件在`App`组件中被使用
   2. `plusName`是事件名，`plusFunc`是在`App`中定义的事件函数

2. 在`Child`组件中如何使用

   1. 组件实例的`_events`上可以找到`plusName`
      1. `_events`是一个对象，这个对象中保存了从组件标签中传入进来的事件，键是事件名，值是一个数组，数组中可以包含多个事件函数
      2. 只是加了`_`的都是私有属性，一般不去使用
   2. `$listeners`上可以找得到，​`$`listeners是一个对象，对象中的键为`plusName`，值为`plusFunc`

### 在子组件标签中使用`ref`

1. 使用

   ```js
   <Child ref="child" />
   ```

   1. `Child`组件在`App`组件中被使用

   2. 在`App`组件实例上可以访问到`Child`这个实例，所以可以通过这给`Child`实例绑定事件

      ```js
        mounted() {
          this.$refs.child.$on("plusName2", () => {
            this.num += 1;
          });
        }
      ```

   3. 在`Child`内部触发这个函数

## 全局事件总线

### `vm.$on(event,callback)`

1. 功能
   1. 绑定事件
2. 参数
   1. `event`
      1. 事件名
   2. `callback`
      1. 事件函数
      2. 同一个事件名可以绑定多个事件函数，触发该事件名时，会按顺序执行所有回调
3. 在`mounted`中进行事件绑定
4. 是`Vue`实例上的方法，在某个实例上绑定就只能在这个实例上触发

### `vm.$emit((eventName,[...args])`

1. 功能
   1. 触发当前实例上的事件
2. 参数
   1. `eventName`:要触发的事件的事件名
   2. `[...args]`:参数可以传入到要被触发的事件的事件函数中

### `vm.$off()`

1. 如果没有提供参数，则移除所有事件监听器，也就是移除所有`on`的绑定，也就是没有绑定事件
2. 如果只提供了事件，则移除该事件所有的监听器，也就是相当于说没有绑定该事件了
3. 如果同时提供了事件与回调，则只移除这个回调的监听器

### `vm.$once()`

绑定的事件能被触发一次，一旦触发之后，监听器就会被移除

### 全局事件总线

1. 目的是要实现在任意组件绑定，任意组件都能触发

2. 过程

   1. 在创建`vm`前先在`Vue`的实例对象上扩展事件总线

   ```js
   Vue.prototype.$bus = new Vue();
   ```

   为什么把`vue`的实例添加到`Vue`的原型对象上

   1. 在内部所有的组件中都可以访问到这个`$bus`的属性
   
    	2. 因为是要绑定事件，绑定事件只能在某个实例上进行绑定，`Vue.prototype.$bus`指向组件实例，那么内部所有的组件都可以在这个实例上绑定事件，也都可以触发这个实例上绑定的事件
